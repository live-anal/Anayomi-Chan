■棒読みちゃんを利用する方法
①Socketで通信する
　外部のプログラムから棒読みちゃんを利用できます。
　Socketが使える言語から利用できます。
　ネットワーク経由でも利用できます。

②IpcClientChannelで通信する
　外部のプログラムから棒読みちゃんを利用できます。
　.NETのプログラムからのみ利用できます。
　ローカル専用です。

③棒読みちゃんプラグインを作成する
　棒読みちゃんに機能を追加できます。
　.NET系の言語でしか作成できません。


■Socket
Socketで、棒読みちゃんのポート(デフォルトでは50001)に、
データを送信することで、棒読みちゃんを制御できます。
詳細はサンプルPGをご覧ください。

送受信するデータのフォーマットは以下のとおりです。

・Talk（読み上げ）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0001)
　　[2-3]   16bit 速度(-1：デフォルト, 50～300)
　　[4-5]   16bit 音程(-1：デフォルト, 50～200)
　　[6-7]   16bit 音量(-1：デフォルト,  0～100)
　　[8-9]   16bit 声質( 0：デフォルト,  1～8:AquesTalk, 10001～:SAPI5)
　　[10]     8bit 文字列の文字コード(0:UTF-8, 1:Unicode, 2:Shift-JIS)
　　[11-14] 32bit 文字列の長さ
　　[15-??] ??bit 文字列データ

・Pause（一時停止）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0010)

・Resume（一時停止の解除）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0020)

・Skip（現在の行をスキップし次の行へ）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0030)

・Clear（残りタスクを全てキャンセル）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0040)

・GetPause（一時停止状態の取得）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0110)

　受信データフォーマット
　　[0]      8bit 一時停止状態(0:一時停止解除中, 1:一時停止中)

・GetNowPlaying（音声再生状態の取得）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0120)

　受信データフォーマット
　　[0]      8bit 一時停止状態(0:無音状態中, 1:音声再生中)

・GetTaskCount（残りタスク数の取得）
　送信データフォーマット
　　[0-1]   16bit コマンド(0x0130)

　受信データフォーマット
　　[0-3]   32bit 残りタスク数


■IpcClientChannel
サンプルPG内の「BouyomiChanClient.cs」を利用すれば、
簡単に読み上げ機能を組み込むことができます。
詳細はサンプルPGをご覧ください。

こんな感じ利用できます・・

using FNF.Utility;

	BouyomiChanClient bc = new BouyomiChanClient();
	
	bc.AddTalkTask("ボク棒読みちゃん");
	bc.AddTalkTask("かわいがってね！", 80, 120, 50, VoiceType.Female2);
	
	bc.Dispose();


■棒読みちゃんプラグイン
BouyomiChan.exeを参照設定して、
IPluginインターフェースを実装したクラスを作成すれば、
棒読みちゃんのプラグインを作成することができます。

ファイル名は「Plugin_*.dll」という形式にし、
棒読みちゃん本体と同じフォルダに配置してください。

詳細はサンプルPGをご覧ください。

IPluginインターフェースを実装したクラスは以下のような感じです・・

public class Plugin_XX : IPlugin {
    //プラグインの名称
    public string       Name     { get { return "××読み上げ"; } }

    //プラグインの備考
    public string       Caption  { get { return "2009/07/01版"; } }

    //プラグインの設定情報（必要なければnull）
    public SettingsBase Settings { get { return null; } }

    //棒読みちゃんの起動時か、プラグインを有効にしたタイミングで呼ばれる処理
    public void Begin() {
        ・・・
    }

    //棒読みちゃんの終了時か、プラグインを無効にしたタイミングで呼ばれる処理
    public void End() {
        ・・・
    }
}

プラグインの中からは、FNF.BouyomiChanApp.Pubクラスが公開している、
静的メソッドやフィールドを利用することで棒読みちゃんにアクセスできます。
Pubクラスには以下のような要素があります。

・Pub.FormMain
　メイン画面に直接アクセスできます。
　ですが、今後のバージョンアップで仕様が変わっていくと思いますので、
　継承元のFormクラスとしての利用だけにしておいたほうが身のためです（＾＾；

・Pub.ToolStrip
　メイン画面のツール領域です。
　ボタンなどを追加できます。

・Pub.Pause
　一時停止状態を取得・設定します。

・Pub.NowPlaying
　現在音声を再生している最中かどうかを取得します。

・Pub.TalkTaskCount
　残りタスクの個数を取得します。

・Pub.AddTalkTask()
　音声合成タスクを登録します。

・Pub.SkipTalkTask()
　現在再生中の行を中止し次の行へ移動します。

・Pub.ClearTalkTasks()
　残りタスク全てをキャンセルします。

・Pub.ShowSettingForm()
　設定画面を表示します
